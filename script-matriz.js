const _0x4aadda=_0x8159;(function(_0x2ddd08,_0x4d7c35){const _0x8a2cd7=_0x8159,_0x2bb2ff=_0x2ddd08();while(!![]){try{const _0x2f6d07=-parseInt(_0x8a2cd7(0xb0))/0x1+parseInt(_0x8a2cd7(0xba))/0x2*(parseInt(_0x8a2cd7(0xb3))/0x3)+-parseInt(_0x8a2cd7(0x9c))/0x4+-parseInt(_0x8a2cd7(0x91))/0x5+-parseInt(_0x8a2cd7(0xa7))/0x6+parseInt(_0x8a2cd7(0x9b))/0x7*(-parseInt(_0x8a2cd7(0xd3))/0x8)+parseInt(_0x8a2cd7(0xac))/0x9;if(_0x2f6d07===_0x4d7c35)break;else _0x2bb2ff['push'](_0x2bb2ff['shift']());}catch(_0x530b8f){_0x2bb2ff['push'](_0x2bb2ff['shift']());}}}(_0x25b5,0x9114a));let datosExcel=[],resultadosFiltrados=[];function _0x8159(_0xc05889,_0x197404){const _0x25b5f4=_0x25b5();return _0x8159=function(_0x815913,_0x58dc2e){_0x815913=_0x815913-0x8d;let _0x47f6b7=_0x25b5f4[_0x815913];return _0x47f6b7;},_0x8159(_0xc05889,_0x197404);}const URL_MATRIZ=_0x4aadda(0x9e);function iniciarApp(){const _0x573a29=_0x4aadda,_0x46ed2c=document['getElementById'](_0x573a29(0xa5));if(_0x46ed2c)_0x46ed2c['style'][_0x573a29(0x92)]='block';cargarDatos();}function cargarDatos(){const _0x7f9e4b=_0x4aadda;fetch(URL_MATRIZ)[_0x7f9e4b(0xc7)](_0x560dc7=>_0x560dc7[_0x7f9e4b(0xb7)]())[_0x7f9e4b(0xc7)](_0x4c2d7a=>{const _0x211605=_0x7f9e4b,_0x172447=Papa[_0x211605(0x96)](_0x4c2d7a,{'header':!![]});datosExcel=_0x172447[_0x211605(0x99)][_0x211605(0xc9)](_0x2f7a2b=>Object[_0x211605(0xa9)](_0x2f7a2b)['some'](_0x14d57f=>_0x14d57f!=='')),resultadosFiltrados=datosExcel,mostrarTabla(resultadosFiltrados),poblarContrapartes(resultadosFiltrados);})[_0x7f9e4b(0xc4)](_0x277700=>{const _0x25dbef=_0x7f9e4b;console[_0x25dbef(0xc3)](_0x25dbef(0xaf),_0x277700),document[_0x25dbef(0xab)](_0x25dbef(0xbf))['textContent']=_0x25dbef(0xcd);});}function mostrarTabla(_0x12a73c){const _0x8211f1=_0x4aadda,_0x5e2665=document[_0x8211f1(0xab)](_0x8211f1(0xd5));if(!_0x5e2665||!_0x12a73c[_0x8211f1(0x97)])return;const _0x535c96=Object[_0x8211f1(0xa8)](_0x12a73c[0x0]);let _0x4e34b2=_0x8211f1(0xd4);_0x535c96[_0x8211f1(0x90)](_0x191fd7=>_0x4e34b2+=_0x8211f1(0xa6)+_0x191fd7+_0x8211f1(0xd9)),_0x4e34b2+=_0x8211f1(0xb5),_0x12a73c['forEach'](_0x250f26=>{const _0x356e8f=_0x8211f1;_0x4e34b2+=_0x356e8f(0xd1),_0x535c96['forEach'](_0x34a0e0=>{const _0x412694=_0x356e8f;let _0x2a6581=_0x250f26[_0x34a0e0];if(_0x34a0e0[_0x412694(0xae)]()===_0x412694(0xc0)){const _0x5d6416=parseFloat(_0x2a6581['toString']()[_0x412694(0x94)](/\./g,'')[_0x412694(0x94)](',','.'));_0x2a6581=isNaN(_0x5d6416)?_0x2a6581:'CLP\x20'+_0x5d6416[_0x412694(0xad)](_0x412694(0xa3));}else{if(_0x34a0e0[_0x412694(0xae)]()==='Monto\x20(USD)'){const _0x385fe9=parseFloat(_0x2a6581[_0x412694(0xa2)]()[_0x412694(0x94)](/\./g,'')[_0x412694(0x94)](',','.'));_0x2a6581=isNaN(_0x385fe9)?_0x2a6581:_0x412694(0x8e)+_0x385fe9[_0x412694(0xad)](_0x412694(0xa3));}}if(_0x34a0e0[_0x412694(0xae)]()===_0x412694(0xc1)){if(_0x2a6581&&_0x2a6581['startsWith'](_0x412694(0xbc))){const _0x2ebfa8=_0x250f26['Contraparte'];_0x2a6581=_0x412694(0xca)+_0x2a6581+'\x22\x20target=\x22_blank\x22\x20style=\x22color:#003087;\x22>Factura\x20emitida\x20por\x20CENCOSUD\x20MATRIZ\x20a\x20'+_0x2ebfa8+_0x412694(0xaa);}}else{if(_0x34a0e0[_0x412694(0xae)]()==='Contrato'){if(_0x2a6581&&_0x2a6581['includes'](_0x412694(0xb8))){const _0x531030=_0x250f26[_0x412694(0x8f)];_0x2a6581=_0x412694(0xca)+_0x2a6581+_0x412694(0xa1)+_0x531030+_0x412694(0xaa);}}else{if(_0x34a0e0[_0x412694(0xae)]()===_0x412694(0xd7)){if(_0x2a6581&&_0x2a6581[_0x412694(0x95)]('Anexo')){const _0x21fa20=_0x250f26[_0x412694(0x8f)];_0x2a6581=_0x412694(0xca)+_0x2a6581+_0x412694(0xdb)+_0x21fa20+_0x412694(0xaa);}}}}_0x4e34b2+='<td>'+_0x2a6581+_0x412694(0xb1);}),_0x4e34b2+=_0x356e8f(0x93);}),_0x4e34b2+='</tbody>',_0x5e2665[_0x8211f1(0xd8)]=_0x4e34b2;}function poblarContrapartes(_0x59da6e){const _0x48a9a0=_0x4aadda,_0x1290c5=document['getElementById']('contraparte');if(!_0x1290c5)return;const _0xe2b94e=Object['keys'](_0x59da6e[0x0]),_0x4d5e43=_0xe2b94e[_0x48a9a0(0xda)](_0x255a38=>normalizar(_0x255a38)[_0x48a9a0(0x95)](_0x48a9a0(0xce)));if(!_0x4d5e43)return;const _0x330651=[...new Set(_0x59da6e[_0x48a9a0(0xb9)](_0x28c17d=>_0x28c17d[_0x4d5e43])[_0x48a9a0(0xc9)](_0x3819fd=>_0x3819fd&&_0x3819fd[_0x48a9a0(0xae)]()!==''))];_0x1290c5[_0x48a9a0(0xd8)]='<option\x20value=\x22\x22>--\x20Selecciona\x20--</option>',_0x330651[_0x48a9a0(0x90)](_0x42943d=>{const _0x12952e=_0x48a9a0,_0x5cb232=document[_0x12952e(0x9a)](_0x12952e(0xbe));_0x5cb232['value']=_0x42943d,_0x5cb232[_0x12952e(0x98)]=_0x42943d,_0x1290c5[_0x12952e(0x9d)](_0x5cb232);});}function filtrar(){const _0x463431=_0x4aadda,_0x1a4bc0=normalizar(document['getElementById'](_0x463431(0xcf))['value']),_0xc05729=normalizar(document['getElementById'](_0x463431(0xce))[_0x463431(0x8d)]),_0x2b349e=normalizar(document[_0x463431(0xab)](_0x463431(0xc6))[_0x463431(0x8d)]),_0xf9d9d2=normalizar(document[_0x463431(0xab)](_0x463431(0xa4))[_0x463431(0x8d)]),_0x2dfe7d=normalizar(document[_0x463431(0xab)]('folio')[_0x463431(0x8d)]);resultadosFiltrados=datosExcel['filter'](_0x5c83d5=>{const _0x32f893=_0x463431,_0x13fbaa=buscarColumna(_0x5c83d5,'tipo\x20de\x20transaccion\x20(Cross-Border\x20o\x20Local)')[_0x32f893(0x95)](_0x1a4bc0),_0x149162=buscarColumna(_0x5c83d5,'contraparte')[_0x32f893(0x95)](_0xc05729),_0x40e8a6=buscarColumna(_0x5c83d5,'ejercicio')[_0x32f893(0x95)](_0x2b349e),_0x2637eb=buscarColumna(_0x5c83d5,_0x32f893(0xa4))[_0x32f893(0x95)](_0xf9d9d2),_0x518cdc=buscarColumna(_0x5c83d5,_0x32f893(0xb4))['includes'](_0x2dfe7d);return _0x13fbaa&&_0x149162&&_0x40e8a6&&_0x2637eb&&_0x518cdc;}),mostrarTabla(resultadosFiltrados);}function buscarColumna(_0x183327,_0x10d089){const _0x696470=_0x4aadda,_0x243c63=Object[_0x696470(0xa8)](_0x183327)[_0x696470(0xda)](_0x9009a3=>normalizar(_0x9009a3)===normalizar(_0x10d089));return normalizar(_0x183327[_0x243c63]||'');}function normalizar(_0x5f1d23){const _0x3563f7=_0x4aadda;return(_0x5f1d23||'')[_0x3563f7(0xa2)]()[_0x3563f7(0xa0)](_0x3563f7(0x9f))[_0x3563f7(0x94)](/[̀-ͯ]/g,'')[_0x3563f7(0x94)](/[^a-zA-Z0-9]/g,'')[_0x3563f7(0xb6)]();}function limpiarFiltro(){const _0x4aa49a=_0x4aadda;document[_0x4aa49a(0xab)](_0x4aa49a(0xcf))[_0x4aa49a(0x8d)]='',document[_0x4aa49a(0xab)]('contraparte')['value']='',document['getElementById']('filtro-anio')[_0x4aa49a(0x8d)]='',document[_0x4aa49a(0xab)](_0x4aa49a(0xa4))[_0x4aa49a(0x8d)]='',document['getElementById'](_0x4aa49a(0xb4))[_0x4aa49a(0x8d)]='',mostrarTabla(datosExcel);}function _0x25b5(){const _0x164cfb=['</tr></thead><tbody>','toLowerCase','text','file','map','2kkHqwQ','logueado','http','addEventListener','option','mensaje','Monto\x20(CLP)','Factura','href','error','catch','index.html','filtro-anio','then','json_to_sheet','filter','<a\x20href=\x22','removeItem','utils','❌\x20No\x20se\x20pudo\x20cargar\x20la\x20base\x20de\x20datos.','contraparte','tipo-transaccion','Facturas','<tr>','DOMContentLoaded','39336RGcbFQ','<thead><tr>','tabla-facturas','book_append_sheet','Estudio\x20de\x20precios','innerHTML','</th>','find','\x22\x20target=\x22_blank\x22\x20style=\x22color:#003087;\x22>Estudio\x20de\x20precios\x20para\x20','value','USD\x20','Contraparte','forEach','1270230RNxjxs','display','</tr>','replace','includes','parse','length','textContent','data','createElement','35Afebfe','1027040HJxyla','appendChild','https://docs.google.com/spreadsheets/d/e/2PACX-1vTfBtHKkKtdElROUoH5dVkHvQpBIo4djRsOCogOCZyqJZMNJ0vYqfc2gQW1hdU-VQx8C4X0CHRIO_6c/pub?gid=0&single=true&output=csv','NFD','normalize','\x22\x20target=\x22_blank\x22\x20style=\x22color:#003087;\x22>Contrato\x20firmado\x20con\x20','toString','es-CL','operacion','contenido-app','<th>','3477024XjdssW','keys','values','</a>','getElementById','14720058DzccUl','toLocaleString','trim','Error\x20al\x20cargar\x20la\x20base:','809790PLJaxx','</td>','location','2650119XnFuxn','folio'];_0x25b5=function(){return _0x164cfb;};return _0x25b5();}function descargarExcel(){const _0x55b311=_0x4aadda,_0x4ac06c=XLSX[_0x55b311(0xcc)][_0x55b311(0xc8)](resultadosFiltrados),_0x2fabef=XLSX[_0x55b311(0xcc)]['book_new']();XLSX[_0x55b311(0xcc)][_0x55b311(0xd6)](_0x2fabef,_0x4ac06c,_0x55b311(0xd0)),XLSX['writeFile'](_0x2fabef,'facturas-filtradas.xlsx');}function volverInicio(){const _0x54263b=_0x4aadda;window[_0x54263b(0xb2)][_0x54263b(0xc2)]=_0x54263b(0xc5);}function cerrarSesion(){const _0x1b6f21=_0x4aadda;sessionStorage[_0x1b6f21(0xcb)](_0x1b6f21(0xbb)),window[_0x1b6f21(0xb2)][_0x1b6f21(0xc2)]='index.html';}document[_0x4aadda(0xbd)](_0x4aadda(0xd2),iniciarApp);